<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Procviƒçov√°n√≠ navij≈°tiny</title>
<style>
:root {
    --bg: #ffffff;
    --text: #000000;
    --card: #f0f0f0;
}
body.dark {
    --bg: #121212;
    --text: #eaeaea;
    --card: #1e1e1e;
}
body {
    background: var(--bg);
    color: var(--text);
    font-family: Arial, sans-serif;
    text-align: center;
    transition: 0.3s;
}
#word-container {
    font-size: 26px;
    margin: 20px;
    background: var(--card);
    padding: 15px;
    border-radius: 10px;
}
.correct { color: #2ecc71; }
.incorrect { color: #e74c3c; }
button, select, input {
    padding: 8px;
    margin: 5px;
    border-radius: 6px;
    border: none;
}
</style>
</head>
<body>

<h1>Procviƒçov√°n√≠ navijsk√Ωch slov√≠ƒçek</h1>

<button onclick="toggleTheme()">üåô / ‚òÄÔ∏è</button><br>

<select id="mode" onchange="startQuiz()">
    <option value="learn">Re≈æim uƒçen√≠</option>
    <option value="test">Re≈æim test</option>
</select>

<div id="timer"></div>
<div id="lives"></div>

<div id="word-container"></div>

<input type="text" id="answer" placeholder="Zadej ƒçesk√Ω p≈ôeklad">
<button onclick="checkAnswer()">Odeslat</button>

<div id="result"></div>
<div id="score"></div>

<button id="restartBtn" onclick="startQuiz()" style="display:none;">Opakovat v≈°e</button>
<button id="mistakeBtn" onclick="repeatMistakes()" style="display:none;">Opakovat chyby</button>

<script>
/* === SLOV√çƒåKA === */
const allWords = [
{ na: "Kaltx√¨", cz: "Ahoj" },
{ na: "Irayo", cz: "Dƒõkuji" },
{ na: "Rutxe", cz: "Pros√≠m" },
{ na: "Oel ngati kameie", cz: "Vid√≠m tƒõ" },
{ na: "K√¨yevame", cz: "Nashledanou" },
{ na: "Ngaru lu fpom srak", cz: "M√°≈° se dob≈ôe?" },
{ na: "oe", cz: "j√°" },
{ na: "nga", cz: "ty" },
{ na: "po", cz: "on/ona" },
{ na: "tsaw", cz: "to" },
{ na: "oeng", cz: "my dva" },
{ na: "menga", cz: "vy dva" },
{ na: "mefo", cz: "oni dva" },
{ na: "pxoeng", cz: "my t≈ôi" },
{ na: "pxenga", cz: "vy t≈ôi" },
{ na: "awnga", cz: "my v≈°ichni" },
{ na: "aynga", cz: "vy v≈°ichni" },
{ na: "ayfo", cz: "oni" },
{ na: "Tute", cz: "Osoba" },
{ na: "Nantang", cz: "Zmije" },
{ na: "Ikran", cz: "Ikran" },
{ na: "Utral", cz: "Strom" },
{ na: "Na‚Äôr√¨ng", cz: "Les" },
{ na: "Kelku", cz: "Domov" },
{ na: "Layon", cz: "ƒåern√°" },
{ na: "Ean", cz: "Modr√° / Zelen√°" },
{ na: "Tun", cz: "ƒåerven√°" },
{ na: "Rim", cz: "≈Ωlut√°" },
{ na: "Teyr", cz: "B√≠l√°" },
{ na: "Lu", cz: "B√Ωt" },
{ na: "Taron", cz: "Lovit" },
{ na: "S√¨", cz: "A" },
{ na: "Srak", cz: "Otazn√≠k" }
];

/* === PROMƒöNN√â === */
let words = [];
let mistakes = [];
let correct = 0;
let lives = 3;
let timer = null;
let timeLeft = 3;
let currentWord;
let repeatMode = false;

/* === FUNKCE === */
function normalize(t){
    return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();
}

function shuffle(a){
    return a.sort(() => Math.random() - 0.5);
}

function startQuiz(custom){
    repeatMode = false;
    words = shuffle(custom ? [...custom] : [...allWords]);
    mistakes = [];
    correct = 0;
    lives = 3;
    clearInterval(timer);
    document.getElementById("score").innerHTML = "";
    document.getElementById("result").textContent = "";
    document.getElementById("restartBtn").style.display = "none";
    document.getElementById("mistakeBtn").style.display = "none";
    nextWord();
}

function nextWord(){
    clearInterval(timer);

    // Pokud nejsou slova, ukonƒç√≠ kv√≠z
    if(words.length === 0){
        if(repeatMode && mistakes.length > 0){
            words = shuffle([...mistakes]);
            mistakes = [];
        } else {
            endQuiz();
            return;
        }
    }

    currentWord = words.shift();
    document.getElementById("word-container").textContent = currentWord.na;
    document.getElementById("answer").value = "";
    document.getElementById("answer").dataset.correct = currentWord.cz;

    if(document.getElementById("mode").value === "test") startTimer();
    updateUI();
}

function startTimer(){
    timeLeft = 3;
    document.getElementById("timer").textContent = `‚è±Ô∏è ${timeLeft}`;
    timer = setInterval(()=>{
        timeLeft--;
        document.getElementById("timer").textContent = `‚è±Ô∏è ${timeLeft}`;
        if(timeLeft <= 0){
            clearInterval(timer);
            wrongAnswer("Vypr≈°el ƒças!");
        }
    },1000);
}

function checkAnswer(){
    clearInterval(timer);
    const user = normalize(document.getElementById("answer").value);
    const correctAns = normalize(document.getElementById("answer").dataset.correct);
    if(user === correctAns){
        document.getElementById("result").textContent = "Spr√°vnƒõ!";
        document.getElementById("result").className = "correct";
        correct++;
        if(repeatMode) mistakes = mistakes.filter(w => w !== currentWord);
        setTimeout(nextWord, 700);
    } else {
        wrongAnswer("≈†patnƒõ!");
    }
}

function wrongAnswer(msg){
    document.getElementById("result").innerHTML = `${msg} Spr√°vnƒõ: <b>${currentWord.cz}</b>`;
    document.getElementById("result").className = "incorrect";
    if(!mistakes.includes(currentWord)) mistakes.push(currentWord);
    if(repeatMode) words.push(currentWord);
    if(document.getElementById("mode").value === "test") lives--;
    setTimeout(nextWord, 1300);
}

function endQuiz(){
    document.getElementById("word-container").textContent = "Hotovo!";
    const percent = Math.round((correct/allWords.length)*100);
    document.getElementById("score").innerHTML = `Spr√°vnƒõ: ${correct} / ${allWords.length}<br>√öspƒõ≈°nost: ${percent}%`;

    document.getElementById("restartBtn").style.display = "inline";
    if(mistakes.length) document.getElementById("mistakeBtn").style.display = "inline";
}

function repeatMistakes(){
    repeatMode = true;
    words = shuffle([...mistakes]);
    mistakes = [];

    // Skryt√≠ tlaƒç√≠tek p≈ôi opakov√°n√≠
    document.getElementById("restartBtn").style.display = "none";
    document.getElementById("mistakeBtn").style.display = "none";

    nextWord();
}

function toggleTheme(){
    document.body.classList.toggle("dark");
    localStorage.theme = document.body.classList.contains("dark") ? "dark" : "light";
}

function updateUI(){
    document.getElementById("lives").textContent = document.getElementById("mode").value === "test" ? `‚ù§Ô∏è ${lives}` : "";
}

document.getElementById("answer").addEventListener("keydown", e => {
    if(e.key === "Enter") checkAnswer();
});

if(localStorage.theme === "dark") document.body.classList.add("dark");

startQuiz();
</script>

</body>
</html>

